<!doctype html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>德州扑克 AI 测试模拟器</title>
        <link rel="icon" href="/simulator/cards/back.png" type="image/png" />
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/icon?family=Material+Icons"
        />
        <style>
            /* --- Base & Reset --- */
            :root {
                --drawer-width: 420px;
                --header-height: 50px;
                --border-color: #ddd;
                --bg-light: #f5f5f5;
                --bg-white: #ffffff;
                --text-dark: #333;
                --text-light: #888;
                --accent-color: #28a745;
            }
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
                font-family:
                    -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
                    sans-serif;
            }
            html,
            body {
                height: 100%;
                overflow: hidden;
                background-color: var(--bg-light);
            }
            .section h3 {
                margin-bottom: 12px;
                font-size: 16px;
                color: var(--text-dark);
                border-bottom: 1px solid var(--border-color);
                padding-bottom: 8px;
            }
            .form-row {
                display: flex;
                align-items: center;
                margin: 8px 0;
                flex-wrap: wrap;
            }
            .form-row label {
                /* width: 120px; */ /* 移除固定宽度以解决间距和换行问题 */
                width: auto; /* 让标签根据其内容自动调整宽度 */
                margin-right: 10px; /* 在标签和输入框之间添加一些间距 */
                font-size: 14px;
                flex-shrink: 0;
            }
            .form-row input,
            .form-row select {
                padding: 6px 10px;
                font-size: 14px;
                border: 1px solid #ccc;
                border-radius: 4px;
            }

            /* --- Main Layout --- */
            .app-container {
                display: flex;
                height: 100vh;
                position: relative;
            }

            /* --- Config Drawer --- */
            .config-drawer {
                position: fixed;
                top: 0;
                left: 0;
                height: 100%;
                width: var(--drawer-width);
                max-width: 90vw;
                background: var(--bg-white);
                z-index: 2000;
                transform: translateX(-100%);
                transition: transform 0.3s ease-in-out;
                overflow-y: auto;
                border-right: 1px solid var(--border-color);
            }
            .config-drawer.is-open {
                transform: translateX(0);
                box-shadow: 3px 0 15px rgba(0, 0, 0, 0.1);
            }
            .config-drawer-content {
                padding: 20px;
            }
            .drawer-close-btn {
                position: absolute;
                top: 10px;
                right: 15px;
                background: none;
                border: none;
                font-size: 28px;
                font-weight: bold;
                color: #888;
                cursor: pointer;
                padding: 0;
                line-height: 1;
            }
            .drawer-close-btn:hover {
                color: #333;
            }

            /* --- Drawer Overlay --- */
            .drawer-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.4);
                z-index: 1999; /* Below drawer, above content */
                opacity: 0;
                visibility: hidden;
                transition:
                    opacity 0.3s ease-in-out,
                    visibility 0.3s ease-in-out;
            }
            .config-drawer.is-open ~ .drawer-overlay {
                opacity: 1;
                visibility: visible;
            }

            /* --- Main Content Area --- */
            .main-content {
                display: flex;
                flex-direction: column; /* Mobile First: Vertical Stack */
                width: 100%;
                height: 100%;
                transition: margin-left 0.3s ease-in-out;
            }

            /* --- Table Area --- */
            .table-area {
                width: 100%;
                height: 70vh; /* Increased height */
                min-height: 550px; /* Increased min-height */
                position: relative;
                display: flex;
                flex-direction: column;
                background: #e8f5e9;
            }
            .poker-table {
                flex-grow: 1;
                position: relative;
                background-color: #2e8b57;
                margin: 10px;
                border-radius: 80px; /* More oval shape */
            }
            .action-bar {
                height: 80px;
                border-top: 1px solid #ccc;
                display: flex;
                align-items: center;
                justify-content: space-around;
            }
            .game-control-btn {
                padding: 8px 16px;
                font-size: 16px;
                border-radius: 8px;
                border: none;
                color: white;
                cursor: pointer;
                transition:
                    background-color 0.2s,
                    transform 0.2s ease-out,
                    box-shadow 0.2s ease-out;
                display: flex;
                align-items: center;
                gap: 8px;
            }
            .game-control-btn:hover:not(:disabled) {
                transform: translateY(-2px);
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            }
            #start-btn {
                background-color: var(--accent-color);
            }
            #start-btn:hover:not(:disabled) {
                background-color: #218838;
            }
            #pause-btn {
                background-color: #ffc107;
            }
            #pause-btn:hover:not(:disabled) {
                background-color: #e0a800;
            }
            #pause-btn:disabled {
                background-color: #6c757d;
                color: #ffffff;
            }
            #config-toggle-btn {
                background-color: #6c757d;
            }
            #game-controls {
                display: flex;
                gap: 10px; /* 增加按钮间距 */
            }

            /* --- Custom Button Colors --- */
            /* "保存快照"和"保存批注"按钮 */
            #save-snapshot-btn,
            #save-snapshot-remarks-btn {
                background-color: #007bff; /* 蓝色主色调 */
                transition: all 0.3s ease;
                position: relative;
                overflow: hidden;
            }
            #save-snapshot-btn:hover,
            #save-snapshot-remarks-btn:hover {
                background-color: #0069d9;
            }

            /* 保存中状态的按钮样式 */
            #save-snapshot-remarks-btn.saving {
                background-color: #6c757d !important;
                cursor: not-allowed;
                transform: scale(0.98);
            }

            /* 保存旋转动画 */
            @keyframes saving-spin {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }

            .saving-spinner {
                animation: saving-spin 1s linear infinite;
            }

            /* 按钮脉冲动画 */
            @keyframes saving-pulse {
                0% {
                    box-shadow: 0 0 0 0 rgba(0, 123, 255, 0.7);
                }
                70% {
                    box-shadow: 0 0 0 10px rgba(0, 123, 255, 0);
                }
                100% {
                    box-shadow: 0 0 0 0 rgba(0, 123, 255, 0);
                }
            }

            #save-snapshot-remarks-btn.saving {
                animation: saving-pulse 2s infinite;
            }

            /* 成功状态动画 */
            @keyframes success-bounce {
                0%,
                20%,
                53%,
                80%,
                100% {
                    transform: scale(1);
                }
                40%,
                43% {
                    transform: scale(1.05);
                }
                70% {
                    transform: scale(0.95);
                }
                90% {
                    transform: scale(1.02);
                }
            }

            #save-snapshot-remarks-btn:not(.saving):not(:hover) {
                transition:
                    transform 0.3s ease,
                    background-color 0.3s ease;
            }

            /* 保存进度条效果 */
            #save-snapshot-remarks-btn::after {
                content: "";
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(
                    90deg,
                    transparent,
                    rgba(255, 255, 255, 0.3),
                    transparent
                );
                transition: left 1.5s ease;
            }

            #save-snapshot-remarks-btn.saving::after {
                left: 100%;
            }

            /* 次要/取消操作的通用样式 */
            .game-control-btn.secondary-btn {
                background-color: #6c757d;
            }
            .game-control-btn.secondary-btn:hover {
                background-color: #5a6268;
            }

            /* 删除确认弹出框的按钮 */
            #delete-confirm-popover #delete-confirm-yes {
                background-color: #dc3545; /* 红色，表示危险操作 */
            }
            #delete-confirm-popover #delete-confirm-yes:hover {
                background-color: #c82333;
            }

            /* 截图确认按钮 */
            #save-snapshot-confirm-btn {
                background-color: var(--accent-color); /* 绿色 */
            }
            #save-snapshot-confirm-btn:hover {
                background-color: #218838; /* 深绿色 */
            }
            #save-snapshot-confirm-btn:hover {
                background-color: #218838;
            }

            .game-control-btn:disabled {
                background-color: #cccccc;
                color: #888888;
                cursor: not-allowed;
            }

            /* --- Info Panel Area (GTO, Console, etc.) --- */
            .info-panel-area {
                padding: 15px;
                display: flex;
                flex-direction: column;
                gap: 20px;
                flex-grow: 1;
                overflow-y: auto;
            }
            .info-panel-area .section {
                background: var(--bg-white);
                padding: 15px;
                border-radius: 8px;
                border: 1px solid var(--border-color);
                display: flex;
                flex-direction: column;
            }
            #suggestion-display {
                padding: 10px;
                background: #272822;
                color: #f8f8f2;
                border-radius: 4px;
                min-height: 200px;
                max-height: 40vh;
                overflow-y: auto;
                font-family: "Courier New", monospace;
                font-size: 13px;
                border: 1px solid #333;
            }
            #console-log {
                flex: 1;
                background: #1e1e1e;
                color: #0f0;
                padding: 12px;
                font-family: "Courier New", monospace;
                font-size: 13px;
                border: 1px solid #333;
                border-radius: 4px;
                resize: none;
                min-height: 150px;
            }
            #action-sheet-container {
                overflow-x: auto;
            }
            #action-sheet {
                border-collapse: collapse;
                width: 100%;
                font-size: 12px;
            }
            #action-sheet th,
            #action-sheet td {
                border: 1px solid #ddd;
                padding: 4px;
                text-align: center;
            }
            #action-sheet thead {
                background-color: #f2f2f2;
            }

            /* --- Desktop Layout --- */
            @media (min-width: 1200px) {
                .config-drawer {
                    position: relative;
                    transform: translateX(0);
                    box-shadow: none;
                    min-width: var(--drawer-width);
                    flex-shrink: 0;
                }
                #config-toggle-btn,
                .drawer-overlay,
                .drawer-close-btn {
                    display: none; /* Hide mobile controls on desktop */
                }
                .main-content {
                    flex-direction: row;
                    /* overflow: hidden; */ /* Removed to prevent clipping player popups */
                }
                .table-area {
                    width: 50%; /* Adjusted width */
                    height: 100%;
                    border-right: 1px solid var(--border-color);
                }
                .info-panel-area {
                    width: 50%; /* Adjusted width */
                    height: 100%;
                    overflow-y: auto;
                    padding: 20px;
                }
            }

            /* --- Player & Card Styles --- */
            .player {
                position: absolute;
                text-align: center;
                width: 100px;
                height: 100px; /* Slightly smaller */
                background: white;
                border: 1px solid #999;
                border-radius: 50%;
                padding: 8px;
                font-size: 12px;
                z-index: 10;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                /* 添加平滑过渡动画效果 */
                transition:
                    left 0.4s cubic-bezier(0.4, 0, 0.2, 1),
                    top 0.4s cubic-bezier(0.4, 0, 0.2, 1),
                    transform 0.4s cubic-bezier(0.4, 0, 0.2, 1),
                    opacity 0.3s ease-in-out;
            }

            /* 玩家活跃时的动画效果 */
            .player:not([style*="opacity: 0"]) {
                animation: playerBounce 0.3s ease-out;
            }

            @keyframes playerBounce {
                0% {
                    transform: translate(-50%, -50%) scale(0.9);
                }
                50% {
                    transform: translate(-50%, -50%) scale(1.05);
                }
                100% {
                    transform: translate(-50%, -50%) scale(1);
                }
            }

            /* 玩家座位变化时的特殊效果 */
            .player.changing-position {
                transition:
                    left 0.5s cubic-bezier(0.34, 1.56, 0.64, 1),
                    top 0.5s cubic-bezier(0.34, 1.56, 0.64, 1),
                    transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1),
                    opacity 0.3s ease-in-out;
            }

            .player-info {
                line-height: 1.2;
            }
            .player-role {
                font-size: 10px;
                color: #e67e22;
            }
            .stack {
                font-size: 11px;
                color: #3498db;
            }
            .player-bet {
                position: absolute;
                bottom: -20px;
                background-color: rgba(0, 0, 0, 0.6);
                color: white;
                padding: 2px 5px;
                border-radius: 3px;
                font-size: 10px;
            }
            .action-bubble {
                position: absolute;
                top: -30px;
                background-color: #f39c12;
                color: white;
                padding: 4px 8px;
                border-radius: 12px;
                font-size: 12px;
                font-weight: bold;
                opacity: 0;
                transform: translateY(10px);
                transition:
                    opacity 0.3s,
                    transform 0.3s;
                z-index: 100;
                white-space: nowrap;
            }
            .action-bubble.show {
                opacity: 1;
                transform: translateY(0);
            }
            @keyframes fade-out {
                from {
                    opacity: 1;
                    transform: translateY(0);
                }
                to {
                    opacity: 0;
                    transform: translateY(-10px);
                }
            }
            .action-bubble.fade-out {
                animation: fade-out 0.5s forwards;
                animation-delay: 1s;
            }
            .fold-indicator {
                display: none;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) rotate(-25deg);
                color: #e74c3c;
                font-size: 22px;
                font-weight: bold;
                border: 3px solid #c0392b;
                padding: 5px 10px;
                border-radius: 8px;
                opacity: 0.85;
                z-index: 50;
            }
            .player.folded {
                opacity: 0.4;
            }
            .player.folded .fold-indicator {
                display: block;
            }
            .player.active {
                border: 2px solid gold;
                box-shadow: 0 0 12px rgba(255, 215, 0, 0.8);
            }
            .hole-cards {
                margin-top: 4px;
                min-height: 45px;
                display: flex;
                gap: 4px;
                justify-content: center;
            }
            .hole-card {
                width: 40px;
                height: 50px;
                background-size: contain;
                background-repeat: no-repeat;
                background-position: center;
            }
            .community-cards {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                display: flex;
                gap: 6px;
                z-index: 5;
            }
            .card {
                width: 40px;
                height: 50px;
                background-size: contain;
                background-repeat: no-repeat;
                background-position: center;
            }
            .pot-display {
                position: absolute;
                top: 25%;
                left: 50%;
                transform: translateX(-50%);
                background-color: rgba(0, 0, 0, 0.6);
                color: #ffd700;
                padding: 4px 12px;
                border-radius: 15px;
                font-size: 16px;
                font-weight: bold;
                z-index: 6;
                border: 1px solid #ffd700;
                box-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
            }
            .player-action-popup {
                position: absolute;
                /* The JS will set top/left, this transform will center it */
                transform: translate(-50%, -50%);
                background: #fff;
                border-radius: 12px;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
                z-index: 110;
                display: none;
                width: 300px; /* A bit wider */
                text-align: center;
                overflow: hidden; /* To respect border-radius */
            }

            .player-action-popup .popup-header {
                background-color: #f7f7f7;
                padding: 8px 12px;
                font-weight: bold;
                font-size: 16px;
                color: #333;
                border-bottom: 1px solid #ddd;
            }

            .player-action-popup .action-buttons {
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                gap: 8px;
                padding: 15px;
            }

            .player-action-popup .action-buttons button {
                border: none;
                border-radius: 6px;
                padding: 10px 12px;
                font-size: 14px;
                font-weight: 500;
                cursor: pointer;
                transition: all 0.2s ease;
                flex-basis: calc(33.333% - 6px); /* Three buttons per row */
                flex-grow: 1;
            }

            .player-action-popup .action-buttons button:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            }

            /* Color coding buttons */
            .player-action-popup button[data-action="FOLD"] {
                background-color: #e74c3c;
                color: white;
            }
            .player-action-popup button[data-action="CHECK"],
            .player-action-popup button[data-action="CALL"] {
                background-color: #3498db;
                color: white;
            }
            .player-action-popup button[data-action="BET"],
            .player-action-popup button[data-action="RAISE"] {
                background-color: #2ecc71;
                color: white;
            }
            .player-action-popup button[data-action="ALLIN"] {
                background-color: #f39c12;
                color: white;
                flex-basis: 100%; /* Make All-in button full width */
            }

            /* --- Amount Slider Section --- */
            .player-action-popup .amount-slider {
                padding: 15px;
                background-color: #f9f9f9;
                border-top: 1px solid #eee;
            }

            .player-action-popup .amount-slider label {
                font-size: 14px;
                font-weight: 500;
                color: #555;
                display: block;
                margin-bottom: 12px;
            }

            .player-action-popup .amount-slider .bet-amount-label {
                font-weight: bold;
                color: #2c3e50;
                background-color: #eee;
                padding: 2px 6px;
                border-radius: 4px;
            }

            .player-action-popup .amount-slider input[type="range"] {
                width: 100%;
                margin: 15px 0;
                -webkit-appearance: none;
                appearance: none;
                height: 8px;
                background: #ddd;
                border-radius: 5px;
                outline: none;
            }

            .player-action-popup
                .amount-slider
                input[type="range"]::-webkit-slider-thumb {
                -webkit-appearance: none;
                appearance: none;
                width: 20px;
                height: 20px;
                background: var(--accent-color);
                cursor: pointer;
                border-radius: 50%;
                border: 2px solid white;
                box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
            }

            .player-action-popup
                .amount-slider
                input[type="range"]::-moz-range-thumb {
                width: 20px;
                height: 20px;
                background: var(--accent-color);
                cursor: pointer;
                border-radius: 50%;
                border: 2px solid white;
                box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
            }

            .player-action-popup .amount-slider .slider-actions {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-top: 10px;
            }

            .player-action-popup .amount-slider .confirm-bet-btn {
                background-color: var(--accent-color);
                color: white;
                border: none;
                border-radius: 6px;
                padding: 10px 20px;
                font-size: 14px;
                font-weight: bold;
                cursor: pointer;
                transition: background-color 0.2s;
            }

            .player-action-popup .amount-slider .confirm-bet-btn:hover {
                background-color: #218838;
            }

            .player-action-popup .amount-slider .cancel-bet-btn {
                background: none;
                border: none;
                color: #888;
                cursor: pointer;
                font-size: 14px;
                padding: 10px;
            }

            .readonly-input {
                background-color: #eee;
            }
            #preset-controls {
                border: 1px solid #ddd;
                padding: 10px;
                border-radius: 4px;
                background: #fdfdfd;
            }
            .preset-card-slot {
                width: 40px;
                height: 50px;
                border: 1px dashed #aaa;
                border-radius: 4px;
                cursor: pointer;
                background-size: contain;
                background-repeat: no-repeat;
                background-position: center;
                display: inline-block;
                vertical-align: middle;
                flex-shrink: 0; /* Prevent shrinking in flex containers */
            }
            .preset-card-slot.active-selection {
                border-color: #f39c12;
                box-shadow: 0 0 5px rgba(243, 156, 18, 0.7);
            }
            #card-picker {
                display: flex;
                flex-wrap: wrap;
                gap: 5px;
                border: 1px solid #eee;
                padding: 5px;
                max-height: 250px;
                overflow-y: auto;
            }
            .picker-card {
                width: 40px;
                height: 50px;
                background-size: contain;
                background-repeat: no-repeat;
                background-position: center;
                cursor: pointer;
                border-radius: 3px;
            }
            .picker-card.dimmed {
                opacity: 0.3;
                cursor: not-allowed;
            }
            #preset-player-hands-container {
                display: grid;
                grid-template-columns: repeat(auto-fill, 160px);
                gap: 10px;
                justify-content: center;
            }
            #preset-player-hands-container > h4 {
                grid-column: 1 / -1;
                margin-bottom: 0;
            }
            .player-hand-preset {
                display: flex;
                align-items: center;
                gap: 5px;
            }

            /* --- New Action Popup V2 Styles --- */
            .player-action-popup {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 240px;
                z-index: 200;

                background: transparent;
                /* No background, padding, or border-radius on the main container */
                box-sizing: border-box;

                display: none;
                justify-content: center;
                align-items: center;

                -webkit-backdrop-filter: none;
                backdrop-filter: none;
            }

            .player-action-popup .action-panel {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 10px;
                width: 100%;
                max-width: 100%;
                /* Background is now on the panel, not the parent popup */
                background: transparent;
                padding: 15px;
                border-radius: 0;
                box-shadow: none;
            }

            .player-action-popup .quick-bet-sizes {
                position: relative;
                width: 180px;
                height: 100px;
                margin: 0 auto 15px auto; /* Center it and add margin below */
            }

            .player-action-popup .quick-bet-sizes button {
                background-color: rgba(0, 0, 0, 0.4);
                border: 1px solid rgba(255, 255, 255, 0.6);
                color: white;
                width: 40px;
                height: 40px;
                border-radius: 50%;
                cursor: pointer;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                font-size: 10px;
                font-weight: bold;
                transition: all 0.2s ease;
                position: absolute;
                transform: translate(
                    -50%,
                    -50%
                ); /* Center the button on its coordinate */
            }

            /* Arc positioning for 5 buttons, centered in a 180x100 box. Arc center at (50%, 100%) with ~90px radius */
            .player-action-popup .quick-bet-sizes button:nth-child(1) {
                left: 1%;
                top: 84%;
            }
            .player-action-popup .quick-bet-sizes button:nth-child(2) {
                left: 18%;
                top: 31%;
            }
            .player-action-popup .quick-bet-sizes button:nth-child(3) {
                left: 50%;
                top: 10%;
            }
            .player-action-popup .quick-bet-sizes button:nth-child(4) {
                left: 82%;
                top: 31%;
            }
            .player-action-popup .quick-bet-sizes button:nth-child(5) {
                left: 99%;
                top: 84%;
            }
            .player-action-popup .quick-bet-sizes button:hover {
                background-color: rgba(255, 255, 255, 0.3);
                transform: translate(-50%, -50%) scale(1.1); /* Correctly combine transforms to prevent jumping */
            }

            .player-action-popup .quick-bet-sizes button:disabled,
            .player-action-popup .quick-bet-sizes button:disabled:hover {
                background-color: rgba(0, 0, 0, 0.2);
                border-color: rgba(255, 255, 255, 0.2);
                color: rgba(255, 255, 255, 0.4);
                cursor: not-allowed;
                transform: translate(-50%, -50%) scale(1); /* 移除并覆盖悬浮动画 */
            }

            .player-action-popup .quick-bet-sizes button span {
                font-size: 1em;
            }

            .player-action-popup .quick-bet-sizes button small {
                font-size: 0.7em;
                font-weight: normal;
                margin-top: 2px;
                color: #eee;
            }

            .player-action-popup .main-action-buttons {
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 15px;
                width: 100%;
            }

            .player-action-popup .main-action-btn {
                border: 2px solid rgba(255, 255, 255, 0.5);
                border-radius: 50%;
                color: white;
                font-size: 14px;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.2s ease;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
                display: flex;
                justify-content: center;
                align-items: center;
                flex-direction: column;
            }

            .player-action-popup .main-action-btn:hover {
                transform: scale(1.08);
                box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
            }

            .player-action-popup .main-action-btn.fold {
                background: linear-gradient(145deg, #d63031, #b71540);
                width: 55px;
                height: 55px;
            }

            .player-action-popup .main-action-btn.bet-raise {
                background: linear-gradient(145deg, #0984e3, #005cb2);
                width: 70px;
                height: 70px;
                font-size: 18px;
            }

            .player-action-popup .main-action-btn.check-call {
                background: linear-gradient(145deg, #27ae60, #1e8449);
                width: 55px;
                height: 55px;
            }

            /* Final attempt to force the All-in button into a circle */
            .main-action-btn.check-call[data-action="ALLIN"] {
                flex: 0 0 55px !important; /* Do not grow, do not shrink, base size 55px */
                max-width: 55px !important;
            }

            /* 新增：确保 bet-raise 按钮在变成 ALLIN 时也保持圆形 */
            .main-action-btn.bet-raise[data-action="ALLIN"] {
                flex: 0 0 70px; /* 固定宽度，防止被内容撑开 */
            }

            .player-action-popup .main-action-btn.check-call .amount {
                display: block; /* Ensure amount appears on a new line */
                font-size: 10px;
                margin-top: 2px;
                font-weight: normal;
            }

            /* --- New Slider Overlay --- */
            .amount-slider-overlay {
                width: 100%;
                padding: 0;
                box-sizing: border-box;
                display: none; /* Initially hidden, JS will set to flex */
                flex-direction: column;
                justify-content: center;
                align-items: center;
                background: transparent;
                border-radius: 0;
            }

            .amount-slider-overlay .slider-container {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 20px;
                position: relative;
            }

            .amount-slider-overlay .slider-value-display {
                /* position: absolute; */ /* Removed to place it in the layout flow */
                /* top: -50px; */
                background: rgba(0, 0, 0, 0.8);
                color: white;
                padding: 4px 15px; /* Smaller padding */
                border-radius: 15px;
                font-size: 18px; /* Smaller font */
                font-weight: bold;
                border: 1px solid rgba(255, 255, 255, 0.5);
            }

            .amount-slider-overlay .slider-track-container {
                position: relative;
                height: 200px;
                width: 50px; /* Thinner container */
                display: flex;
                justify-content: center;
                align-items: center;
                background: rgba(
                    0,
                    0,
                    0,
                    0.3
                ); /* 新增：给轨道一个半透明的黑色背景 */
                border: 1px solid rgba(255, 255, 255, 0.4); /* But with a border to be visible */
                box-shadow: none;
                border-radius: 25px; /* 50px width / 2 */
                padding: 15px 0;
            }

            .amount-slider-overlay .bet-slider-input {
                -webkit-appearance: none;
                appearance: none;
                width: 170px; /* The 'width' of a vertical slider is its length */
                height: 10px;
                background: transparent;
                transform: rotate(-90deg);
                cursor: pointer;
                position: absolute;
            }

            .amount-slider-overlay
                .bet-slider-input::-webkit-slider-runnable-track {
                background: #555;
                height: 2px;
                border-radius: 1px;
            }

            .amount-slider-overlay .bet-slider-input::-webkit-slider-thumb {
                -webkit-appearance: none;
                appearance: none;
                width: 40px;
                height: 40px;
                background: #f39c12;
                border-radius: 50%;
                border: 4px solid white;
                margin-top: -19px; /* Re-center thumb on 2px track */
                box-shadow: 0 0 10px rgba(243, 156, 18, 0.7);
            }

            .amount-slider-overlay .bet-slider-input::-moz-range-track {
                background: #555;
                height: 2px;
                border-radius: 1px;
            }

            .amount-slider-overlay .bet-slider-input::-moz-range-thumb {
                width: 40px;
                height: 40px;
                background: #f39c12;
                border-radius: 50%;
                border: 4px solid white;
                box-shadow: 0 0 10px rgba(243, 156, 18, 0.7);
            }

            .amount-slider-overlay .confirm-bet {
                background: linear-gradient(145deg, #0984e3, #005cb2);
                width: 70px;
                height: 70px;
                font-size: 18px;
                border: 2px solid rgba(255, 255, 255, 0.5);
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            }
            .modal-footer .secondary-btn:hover {
                background-color: #5a6268;
            }

            /* --- Modal Styles --- */
            .modal-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.7);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 3000; /* Higher than config drawer */
                visibility: hidden;
                opacity: 0;
                transition:
                    visibility 0.3s,
                    opacity 0.3s;
            }

            .modal-overlay.is-visible {
                visibility: visible;
                opacity: 1;
            }

            .modal-content {
                background: var(--bg-white);
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
                width: 90%;
                max-width: 600px;
                transform: translateY(-20px);
                transition: transform 0.3s ease-out;
            }

            .modal-overlay.is-visible .modal-content {
                transform: translateY(0);
            }

            .modal-content h3 {
                margin-top: 0;
                margin-bottom: 15px;
                color: var(--text-dark);
                border-bottom: 1px solid var(--border-color);
                padding-bottom: 10px;
            }

            .modal-body {
                margin-bottom: 15px;
            }

            .modal-footer {
                display: flex;
                justify-content: flex-end;
                gap: 10px;
            }

            .modal-footer .game-control-btn {
                padding: 8px 16px;
                font-size: 14px;
                border-radius: 6px;
            }

            .modal-footer .secondary-btn {
                background-color: #6c757d;
            }
            .modal-footer .secondary-btn:hover {
                background-color: #5a6268;
            }

            /* --- Snapshot List Styles --- */
            #snapshot-list li {
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: 8px;
                border-bottom: 1px dashed #eee;
                font-size: 13px;
                color: #333;
            }
            #snapshot-list li:last-child {
                border-bottom: none;
            }
            #snapshot-list li:hover {
                background-color: #f9f9f9;
            }
            #snapshot-list li .snapshot-info {
                flex-grow: 1;
                margin-right: 10px;
                min-width: 0; /* Flexbox fix for ellipsis */
            }
            #snapshot-list li .snapshot-info strong {
                color: #007bff;
                cursor: pointer;
                display: block;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }
            #snapshot-list li .snapshot-info strong:hover {
                text-decoration: underline;
            }

            .snapshot-name-edit {
                font-size: 1em;
                font-weight: bold;
                color: #007bff;
                border: 1px solid #007bff;
                padding: 1px 3px;
                border-radius: 3px;
                width: 95%;
            }

            #snapshot-list li .snapshot-actions {
                display: flex;
                flex-shrink: 0;
                gap: 5px;
            }

            #snapshot-list li .snapshot-actions button {
                padding: 4px 8px;
                font-size: 12px;
                border-radius: 4px;
                cursor: pointer;
                border: 1px solid #ccc;
                background-color: #f0f0f0;
                white-space: nowrap;
            }
            #snapshot-list li .snapshot-actions button:hover {
                background-color: #e0e0e0;
            }
            #snapshot-list li .snapshot-actions .load-btn {
                background-color: #28a745;
                color: white;
                border-color: #28a745;
            }
            #snapshot-list li .snapshot-actions .load-btn:hover {
                background-color: #218838;
            }
            #snapshot-list li .snapshot-actions .suggest-btn {
                background-color: #007bff;
                color: white;
                border-color: #007bff;
            }
            #snapshot-list li .snapshot-actions .suggest-btn:hover {
                background-color: #0069d9;
            }
            #snapshot-list li .snapshot-actions .delete-btn {
                background-color: #dc3545;
                color: white;
                border-color: #dc3545;
            }
            #snapshot-list li .snapshot-actions .delete-btn:hover {
                background-color: #c82333;
            }

            /* 新增：查看快照按钮样式 (蓝色) */
            #snapshot-list li .snapshot-actions .view-btn {
                background-color: #007bff;
                color: white;
                border-color: #007bff;
            }
            #snapshot-list li .snapshot-actions .view-btn:hover {
                background-color: #0069d9;
            }

            /* 新增：回放按钮样式 (绿色) */
            #snapshot-list li .snapshot-actions .replay-btn {
                background-color: #28a745;
                color: white;
                border-color: #28a745;
            }
            #snapshot-list li .snapshot-actions .replay-btn:hover {
                background-color: #218838;
            }

            /* 新增：回放控制面板按钮颜色 */
            #replay-play-pause-btn {
                background-color: #28a745;
                color: white;
            } /* 绿色 */
            #replay-play-pause-btn:hover:not(:disabled) {
                background-color: #218838;
            }
            #replay-play-pause-btn:disabled {
                background-color: #6c757d;
                color: white;
            } /* 禁用时灰色背景，白色文字 */
            #replay-play-pause-btn:disabled:hover {
                background-color: #6c757d;
            } /* 禁用时悬停不变色 */

            #replay-next-btn,
            #replay-prev-btn {
                background-color: #17a2b8;
                color: white;
            } /* 信息蓝 */
            #replay-next-btn:hover:not(:disabled),
            #replay-prev-btn:hover:not(:disabled) {
                background-color: #138496;
            }
            #replay-next-btn:disabled,
            #replay-prev-btn:disabled {
                background-color: #6c757d;
                color: white;
            } /* 禁用时灰色背景，白色文字 */
            #replay-next-btn:disabled:hover,
            #replay-prev-btn:disabled:hover {
                background-color: #6c757d;
            } /* 禁用时悬停不变色 */

            #replay-reset-btn {
                background-color: #ffc107;
                color: #212529;
            } /* 警告黄 */
            #replay-reset-btn:hover:not(:disabled) {
                background-color: #e0a800;
            }
            #replay-reset-btn:disabled {
                background-color: #6c757d;
                color: white;
            } /* 禁用时灰色背景，白色文字 */
            #replay-reset-btn:disabled:hover {
                background-color: #6c757d;
            } /* 禁用时悬停不变色 */

            #replay-exit-btn {
                background-color: #dc3545;
                color: white;
            } /* 危险红色 */
            #replay-exit-btn:hover:not(:disabled) {
                background-color: #c82333;
            }
            #replay-exit-btn:disabled {
                background-color: #6c757d;
                color: white;
            } /* 禁用时灰色背景，白色文字 */
            #replay-exit-btn:disabled:hover {
                background-color: #6c757d;
            } /* 禁用时悬停不变色 */

            /* 危险按钮特殊样式 */
            .game-control-btn.danger-btn {
                border: 2px solid #dc3545;
                font-weight: bold;
                transition: all 0.2s ease;
                box-shadow: 0 2px 4px rgba(220, 53, 69, 0.2);
            }
            .game-control-btn.danger-btn:hover:not(:disabled) {
                transform: translateY(-1px);
                box-shadow: 0 4px 8px rgba(220, 53, 69, 0.3);
            }
            .game-control-btn.danger-btn:active:not(:disabled) {
                transform: translateY(0);
                box-shadow: 0 1px 2px rgba(220, 53, 69, 0.2);
            }
            .game-control-btn.danger-btn:disabled {
                border: 2px solid #6c757d;
                box-shadow: none;
                transform: none;
            }

            /* 快照分页按钮美化样式 - 纯蓝色渐变 */
            #snapshot-prev-btn,
            #snapshot-next-btn {
                background: linear-gradient(
                    135deg,
                    #4a90e2 0%,
                    #357abd 100%
                ) !important;
                border: none;
                border-radius: 25px;
                color: white !important;
                font-weight: 600;
                padding: 10px 18px;
                transition: all 0.3s ease;
                box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
                position: relative;
                overflow: hidden;
                font-size: 14px;
                min-width: 85px;
                flex-shrink: 0;
                white-space: nowrap;
            }

            #snapshot-prev-btn:hover:not(:disabled),
            #snapshot-next-btn:hover:not(:disabled) {
                background: linear-gradient(
                    135deg,
                    #357abd 0%,
                    #2968a3 100%
                ) !important;
                transform: translateY(-2px);
                box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
            }

            #snapshot-prev-btn:active:not(:disabled),
            #snapshot-next-btn:active:not(:disabled) {
                transform: translateY(0);
                box-shadow: 0 2px 10px rgba(74, 144, 226, 0.3);
            }

            #snapshot-prev-btn:disabled,
            #snapshot-next-btn:disabled {
                background: linear-gradient(
                    135deg,
                    #adb5bd 0%,
                    #6c757d 100%
                ) !important;
                color: #e9ecef !important;
                cursor: not-allowed;
                transform: none;
                box-shadow: none;
                opacity: 0.7;
            }

            /* 分页按钮文字样式优化 */
            #snapshot-prev-btn,
            #snapshot-next-btn {
                font-weight: 500;
                letter-spacing: 0.5px;
                min-width: 80px;
            }

            /* 添加光泽扫过效果 */
            #snapshot-prev-btn,
            #snapshot-next-btn {
                position: relative;
                overflow: hidden;
            }

            #snapshot-prev-btn::after,
            #snapshot-next-btn::after {
                content: "";
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(
                    90deg,
                    transparent,
                    rgba(255, 255, 255, 0.2),
                    transparent
                );
                transition: left 0.5s ease;
                z-index: 1;
            }

            #snapshot-prev-btn:hover:not(:disabled)::after,
            #snapshot-next-btn:hover:not(:disabled)::after {
                left: 100%;
            }

            /* 禁用状态下禁用动画 */
            #snapshot-prev-btn:disabled::after,
            #snapshot-next-btn:disabled::after {
                display: none;
            }

            /* 分页容器美化 */
            #snapshot-pagination-controls {
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 15px;
                padding: 16px;
                margin-top: 16px;
                flex-wrap: nowrap;
            }

            #snapshot-pagination-controls span {
                font-size: 15px;
                color: #495057;
                font-weight: 600;
                background: white;
                padding: 8px 16px;
                border-radius: 6px;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
                min-width: 120px;
                text-align: center;
                border: 1px solid #e9ecef;
                letter-spacing: 0.5px;
            }

            /* 分页按钮加载动画 */
            @keyframes pagination-pulse {
                0% {
                    box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
                }
                50% {
                    box-shadow: 0 4px 25px rgba(74, 144, 226, 0.5);
                }
                100% {
                    box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
                }
            }

            #snapshot-prev-btn:not(:disabled):hover,
            #snapshot-next-btn:not(:disabled):hover {
                animation: pagination-pulse 1.5s infinite;
            }

            /* 按钮容器响应式设计 */
            @media (max-width: 480px) {
                #snapshot-pagination-controls {
                    padding: 12px;
                    gap: 10px;
                }

                #snapshot-prev-btn,
                #snapshot-next-btn {
                    padding: 8px 14px;
                    min-width: 75px;
                    font-size: 13px;
                }

                #snapshot-pagination-controls span {
                    font-size: 13px;
                    padding: 6px 10px;
                    min-width: 80px;
                }
            }

            /* 超小屏幕额外优化 */
            @media (max-width: 360px) {
                #snapshot-pagination-controls {
                    gap: 8px;
                    padding: 10px;
                }

                #snapshot-prev-btn,
                #snapshot-next-btn {
                    padding: 6px 12px;
                    min-width: 70px;
                    font-size: 12px;
                }

                #snapshot-pagination-controls span {
                    font-size: 12px;
                    padding: 4px 8px;
                    min-width: 70px;
                }
            }

            #snapshot-list-container {
                max-height: 210px; /* 大约3个列表项的高度 */
                overflow-y: auto;
                border: 1px solid #eee;
                padding: 10px;
                border-radius: 4px;
                background: #fdfdfd;
                /* 用于居中加载动画 */
                position: relative;
                min-height: 120px;
            }

            /* 快照加载动画样式 */
            .snapshot-loading {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                padding: 40px 20px;
                color: #888;
                font-size: 14px;
            }

            .snapshot-loading-spinner {
                width: 32px;
                height: 32px;
                border: 3px solid #f3f3f3;
                border-top: 3px solid #007bff;
                border-radius: 50%;
                animation: snapshot-loading-spin 1s linear infinite;
                margin-bottom: 12px;
            }

            .snapshot-loading-text {
                font-size: 14px;
                color: #666;
                margin-top: 8px;
            }

            @keyframes snapshot-loading-spin {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }

            /* 快照列表状态提示样式 */
            .snapshot-status {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                padding: 40px 20px;
                color: #888;
                font-size: 14px;
                text-align: center;
            }

            .snapshot-status-icon {
                font-size: 32px;
                margin-bottom: 12px;
                opacity: 0.6;
            }

            .snapshot-status-text {
                font-size: 14px;
                color: #666;
                line-height: 1.4;
            }

            .snapshot-status.error .snapshot-status-icon {
                color: #dc3545;
            }

            .snapshot-status.error .snapshot-status-text {
                color: #dc3545;
            }

            .snapshot-status.empty .snapshot-status-icon {
                color: #ffc107;
            }

            .snapshot-status.empty .snapshot-status-text {
                color: #856404;
            }

            /* 为快照列表定制滚动条样式 */
            #snapshot-list-container::-webkit-scrollbar {
                width: 10px;
            }

            #snapshot-list-container::-webkit-scrollbar-track {
                background: #f1f1f1;
                border-radius: 10px;
            }

            #snapshot-list-container::-webkit-scrollbar-thumb {
                background: #888;
                border-radius: 10px;
            }

            #snapshot-list-container::-webkit-scrollbar-thumb:hover {
                background: #555;
            }

            /* --- Styles for View Snapshot Modal --- */
            .snapshot-suggestion-item {
                display: flex;
                gap: 15px;
                padding: 10px;
                border-bottom: 1px solid #e0e0e0;
            }
            .snapshot-suggestion-item:last-child {
                border-bottom: none;
            }
            .snapshot-suggestion-content {
                flex: 2;
            }
            .snapshot-suggestion-notes {
                flex: 1;
                display: flex;
                flex-direction: column;
            }
            .snapshot-suggestion-notes textarea {
                width: 100%;
                height: 100%;
                min-height: 80px;
                resize: vertical;
                padding: 5px;
                border: 1px solid #ccc;
                border-radius: 4px;
                font-size: 13px;
            }

            /* --- Styles for Screenshot Selection --- */
            #screenshot-selection-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                background: rgba(100, 100, 100, 0.4);
                cursor: crosshair;
                z-index: 9998;
            }
            #selection-box {
                position: absolute;
                background: rgba(255, 255, 255, 0.3);
                border: 1px dashed #fff;
            }

            /* --- Styles for Delete Confirmation Popover --- */
            #delete-confirm-popover {
                position: absolute;
                background: #fff;
                border: 1px solid #ccc;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                padding: 15px;
                z-index: 4000;
                width: 220px;
                text-align: center;
            }
            #delete-confirm-popover p {
                margin: 0 0 15px 0;
                font-size: 14px;
                color: #333;
            }
            #delete-confirm-popover .popover-actions {
                display: flex;
                justify-content: space-around;
            }
            #delete-confirm-popover .popover-actions button {
                padding: 6px 12px;
                font-size: 13px;
            }
            #delete-confirm-popover #delete-confirm-yes {
                background-color: #dc3545;
            }
            #delete-confirm-popover #delete-confirm-yes:hover {
                background-color: #c82333;
            }

            /* 新增：图片悬浮提示样式 */
            #image-hover-overlay {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0, 0, 0, 0.65);
                color: white;
                padding: 10px 20px;
                border-radius: 6px;
                display: flex;
                justify-content: center;
                align-items: center;
                font-size: 16px;
                font-weight: bold;
                pointer-events: none;
                opacity: 0;
                visibility: hidden;
                transition:
                    opacity 0.2s ease-in-out,
                    visibility 0.2s ease-in-out;
            }

            #view-snapshot-image-container:hover #image-hover-overlay {
                opacity: 1;
                visibility: visible;
            }
            /* --- Toast Notification --- */
            .toast-notification {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) scale(0.9);
                background-color: rgba(
                    0,
                    123,
                    255,
                    0.95
                ); /* Success teal (blue-green) */
                color: white;
                padding: 16px 32px;
                border-radius: 8px;
                z-index: 9999;
                font-size: 1.1em;
                font-weight: 600;
                box-shadow: 0 5px 20px rgba(0, 0, 0, 0.25);
                opacity: 0;
                transition:
                    opacity 0.3s ease,
                    transform 0.3s ease;
                pointer-events: none; /* Allow clicks to pass through */
            }

            .toast-notification.show {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }

            .toast-notification.error {
                background-color: rgba(220, 53, 69, 0.95); /* Error red */
            }
            /* --- Global Loader --- */
            .loader-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 9999; /* Highest z-index */
            }

            .loader-spinner {
                border: 8px solid #f3f3f3; /* Light grey */
                border-top: 8px solid #3498db; /* Blue */
                border-radius: 50%;
                width: 60px;
                height: 60px;
                animation: spin 1s linear infinite;
            }

            @keyframes spin {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }

            #screenshot-prompt-overlay {
                position: fixed;
                top: -100px;
                left: 50%;
                transform: translateX(-50%);
                background-color: rgba(
                    28,
                    28,
                    28,
                    0.85
                ); /* 将背景色从绿色改为深灰色半透明 */
                color: white;
                padding: 12px 25px;
                border-radius: 8px; /* 修改：将圆角应用于所有四个角 */
                font-size: 16px;
                font-weight: bold;
                z-index: 9997;
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
                opacity: 0;
                transition:
                    opacity 0.3s ease-in-out,
                    top 0.3s ease-in-out;
                pointer-events: none;
            }
        </style>
    </head>
    <body>
        <div id="screenshot-prompt-overlay">
            请在屏幕上拖动以选择截图区域 (按 ESC 取消)
        </div>
        <div class="app-container">
            <!-- Slide-out Drawer for Configurations -->
            <aside id="config-drawer" class="config-drawer">
                <button class="drawer-close-btn">&times;</button>
                <div class="config-drawer-content">
                    <div class="section" id="runtime-config-section">
                        <h3>⚙️ 运行配置</h3>
                        <div class="form-row">
                            <label>游戏模式:</label>
                            <select id="mode-select">
                                <option value="auto">自动</option>
                                <option value="manual">手动</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <label>盲注设置:</label>
                            <input
                                type="number"
                                id="sb-input"
                                value="50"
                                min="1"
                                style="width: 80px"
                            />
                            /
                            <input
                                type="number"
                                id="bb-input"
                                value="100"
                                min="1"
                                style="width: 80px"
                                class="readonly-input"
                                readonly
                            />
                        </div>
                        <div class="form-row">
                            <label>玩家思考时间 (ms):</label>
                            <input
                                type="number"
                                id="auto-delay"
                                value="1000"
                                min="100"
                                style="width: 100px"
                            />
                        </div>
                        <div class="form-row">
                            <label>GTO建议阶段:</label>
                            <div id="suggestion-phases">
                                <label style="margin-right: 10px; width: auto"
                                    ><input
                                        type="checkbox"
                                        id="suggest-preflop"
                                        checked
                                    />
                                    Preflop</label
                                >
                                <label style="margin-right: 10px; width: auto"
                                    ><input
                                        type="checkbox"
                                        id="suggest-flop"
                                        checked
                                    />
                                    Flop</label
                                >
                                <label style="margin-right: 10px; width: auto"
                                    ><input
                                        type="checkbox"
                                        id="suggest-turn"
                                        checked
                                    />
                                    Turn</label
                                >
                                <label style="margin-right: 10px; width: auto"
                                    ><input
                                        type="checkbox"
                                        id="suggest-river"
                                        checked
                                    />
                                    River</label
                                >
                            </div>
                        </div>
                        <div class="form-row">
                            <label>GTO建议筛选:</label>
                            <div
                                id="gto-filter-players"
                                style="
                                    display: flex;
                                    flex-wrap: wrap;
                                    align-items: center;
                                "
                            ></div>
                        </div>
                        <div class="form-row">
                            <label>玩家数量:</label>
                            <input
                                type="number"
                                id="player-count-input"
                                value="8"
                                min="2"
                                max="8"
                                style="width: 50px"
                            />
                            <label
                                style="
                                    width: auto;
                                    margin-left: 15px;
                                    margin-right: 10px;
                                "
                                >底池类型:</label
                            >
                            <select id="pot-type-select" style="width: 130px">
                                <option value="unrestricted">无限制</option>
                                <option value="single_raised">
                                    单一加注底池
                                </option>
                                <option value="3bet">3-Bet 底池</option>
                                <option value="4bet">4-Bet及以上</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <label>P1开局位置:</label>
                            <select id="p1-role-select"></select>
                        </div>
                        <div class="form-row">
                            <label>初始筹码范围:</label>
                            <input
                                type="number"
                                id="min-stack-input"
                                value="1800"
                                min="1"
                                style="width: 80px"
                            />
                            -
                            <input
                                type="number"
                                id="max-stack-input"
                                value="2200"
                                min="1"
                                style="width: 80px"
                            />
                        </div>
                    </div>

                    <div class="section" id="preset-section">
                        <h3>🃏 牌局预设</h3>
                        <div class="form-row">
                            <label>预设选项:</label>
                            <label style="width: auto; margin-left: 20px">
                                <input
                                    type="checkbox"
                                    id="use-preset-community-checkbox"
                                />
                                预设公共牌
                            </label>
                            <label style="width: auto; margin-left: 10px">
                                <input
                                    type="checkbox"
                                    id="use-preset-hands-checkbox"
                                />
                                预设手牌
                            </label>
                        </div>
                        <div id="preset-controls" class="hidden-by-js">
                            <div
                                id="preset-community-cards-container"
                                style="margin-top: 15px"
                            >
                                <h4>公共牌:</h4>
                                <div
                                    style="
                                        display: flex;
                                        align-items: center;
                                        gap: 5px;
                                    "
                                >
                                    <strong>Flop:</strong>
                                    <div
                                        class="preset-card-slot"
                                        data-type="community"
                                        data-stage="flop"
                                        data-card-index="0"
                                    ></div>
                                    <div
                                        class="preset-card-slot"
                                        data-type="community"
                                        data-stage="flop"
                                        data-card-index="1"
                                    ></div>
                                    <div
                                        class="preset-card-slot"
                                        data-type="community"
                                        data-stage="flop"
                                        data-card-index="2"
                                    ></div>
                                    <strong style="margin-left: -1px"
                                        >Turn:</strong
                                    >
                                    <div
                                        class="preset-card-slot"
                                        data-type="community"
                                        data-stage="turn"
                                        data-card-index="0"
                                    ></div>
                                    <strong style="margin-left: -1px"
                                        >River:</strong
                                    >
                                    <div
                                        class="preset-card-slot"
                                        data-type="community"
                                        data-stage="river"
                                        data-card-index="0"
                                    ></div>
                                </div>
                            </div>
                            <div
                                id="preset-player-hands-container"
                                style="margin-top: 15px; margin-bottom: 15px"
                            ></div>
                            <div
                                id="card-picker-container"
                                style="margin-top: 15px"
                            >
                                <h4>选择扑克牌:</h4>
                                <div id="card-picker"></div>
                            </div>
                        </div>
                    </div>

                    <div class="section" id="snapshot-management-section">
                        <h3>💾 牌局快照管理</h3>
                        <div id="snapshot-list-container">
                            <ul
                                id="snapshot-list"
                                style="list-style: none; padding: 0; margin: 0"
                            >
                                <!-- Snapshots will be rendered here -->
                            </ul>
                        </div>
                        <div
                            id="snapshot-pagination-controls"
                            style="
                                padding-top: 10px;
                                display: flex;
                                justify-content: center;
                                align-items: center;
                                gap: 15px;
                            "
                        >
                            <!-- Pagination controls will be rendered here -->
                        </div>
                    </div>
                </div>
            </aside>
            <div class="drawer-overlay"></div>

            <!-- Main Content -->
            <main class="main-content">
                <div class="table-area">
                    <div class="poker-table">
                        <!-- Players P1-P8 -->
                        <div class="player" data-player="P1">
                            <div class="fold-indicator">FOLD</div>
                            <div class="player-info">
                                P1 <span class="player-role"></span><br /><span
                                    class="stack"
                                ></span>
                            </div>
                            <div class="player-bet"></div>
                            <div class="action-bubble"></div>
                            <div class="hole-cards">
                                <div class="hole-card"></div>
                                <div class="hole-card"></div>
                            </div>
                            <div
                                class="player-action-popup"
                                style="display: none"
                            >
                                <div class="action-panel">
                                    <div class="quick-bet-sizes">
                                        <button data-size-multiplier="0.33">
                                            <span>1/3</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="0.5">
                                            <span>1/2</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="0.66">
                                            <span>2/3</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="1">
                                            <span>1</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="1.2">
                                            <span>1.2</span><small>0</small>
                                        </button>
                                    </div>
                                    <div class="main-action-buttons">
                                        <button
                                            class="main-action-btn fold"
                                            data-action="FOLD"
                                        >
                                            弃牌
                                        </button>
                                        <button
                                            class="main-action-btn bet-raise"
                                            data-action="BET"
                                        >
                                            下注
                                        </button>
                                        <button
                                            class="main-action-btn check-call"
                                            data-action="CHECK"
                                        >
                                            让牌
                                        </button>
                                    </div>
                                </div>
                                <div
                                    class="amount-slider-overlay"
                                    style="display: none"
                                >
                                    <div class="slider-container">
                                        <div class="slider-value-display">
                                            0
                                        </div>
                                        <div class="slider-track-container">
                                            <input
                                                type="range"
                                                class="bet-slider-input"
                                                min="0"
                                                max="100"
                                                step="1"
                                                value="0"
                                            />
                                        </div>
                                        <button
                                            class="main-action-btn confirm-bet"
                                            data-action="CONFIRM"
                                        >
                                            确定
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="player" data-player="P2">
                            <div class="fold-indicator">FOLD</div>
                            <div class="player-info">
                                P2 <span class="player-role"></span><br /><span
                                    class="stack"
                                ></span>
                            </div>
                            <div class="player-bet"></div>
                            <div class="action-bubble"></div>
                            <div class="hole-cards">
                                <div class="hole-card"></div>
                                <div class="hole-card"></div>
                            </div>
                            <div
                                class="player-action-popup"
                                style="display: none"
                            >
                                <div class="action-panel">
                                    <div class="quick-bet-sizes">
                                        <button data-size-multiplier="0.33">
                                            <span>1/3</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="0.5">
                                            <span>1/2</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="0.66">
                                            <span>2/3</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="1">
                                            <span>1</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="1.2">
                                            <span>1.2</span><small>0</small>
                                        </button>
                                    </div>
                                    <div class="main-action-buttons">
                                        <button
                                            class="main-action-btn fold"
                                            data-action="FOLD"
                                        >
                                            弃牌
                                        </button>
                                        <button
                                            class="main-action-btn bet-raise"
                                            data-action="BET"
                                        >
                                            下注
                                        </button>
                                        <button
                                            class="main-action-btn check-call"
                                            data-action="CHECK"
                                        >
                                            让牌
                                        </button>
                                    </div>
                                </div>
                                <div
                                    class="amount-slider-overlay"
                                    style="display: none"
                                >
                                    <div class="slider-container">
                                        <div class="slider-value-display">
                                            0
                                        </div>
                                        <div class="slider-track-container">
                                            <input
                                                type="range"
                                                class="bet-slider-input"
                                                min="0"
                                                max="100"
                                                step="1"
                                                value="0"
                                            />
                                        </div>
                                        <button
                                            class="main-action-btn confirm-bet"
                                            data-action="CONFIRM"
                                        >
                                            确定
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="player" data-player="P3">
                            <div class="fold-indicator">FOLD</div>
                            <div class="player-info">
                                P3 <span class="player-role"></span><br /><span
                                    class="stack"
                                ></span>
                            </div>
                            <div class="player-bet"></div>
                            <div class="action-bubble"></div>
                            <div class="hole-cards">
                                <div class="hole-card"></div>
                                <div class="hole-card"></div>
                            </div>
                            <div
                                class="player-action-popup"
                                style="display: none"
                            >
                                <div class="action-panel">
                                    <div class="quick-bet-sizes">
                                        <button data-size-multiplier="0.33">
                                            <span>1/3</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="0.5">
                                            <span>1/2</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="0.66">
                                            <span>2/3</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="1">
                                            <span>1</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="1.2">
                                            <span>1.2</span><small>0</small>
                                        </button>
                                    </div>
                                    <div class="main-action-buttons">
                                        <button
                                            class="main-action-btn fold"
                                            data-action="FOLD"
                                        >
                                            弃牌
                                        </button>
                                        <button
                                            class="main-action-btn bet-raise"
                                            data-action="BET"
                                        >
                                            下注
                                        </button>
                                        <button
                                            class="main-action-btn check-call"
                                            data-action="CHECK"
                                        >
                                            让牌
                                        </button>
                                    </div>
                                </div>
                                <div
                                    class="amount-slider-overlay"
                                    style="display: none"
                                >
                                    <div class="slider-container">
                                        <div class="slider-value-display">
                                            0
                                        </div>
                                        <div class="slider-track-container">
                                            <input
                                                type="range"
                                                class="bet-slider-input"
                                                min="0"
                                                max="100"
                                                step="1"
                                                value="0"
                                            />
                                        </div>
                                        <button
                                            class="main-action-btn confirm-bet"
                                            data-action="CONFIRM"
                                        >
                                            确定
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="player" data-player="P4">
                            <div class="fold-indicator">FOLD</div>
                            <div class="player-info">
                                P4 <span class="player-role"></span><br /><span
                                    class="stack"
                                ></span>
                            </div>
                            <div class="player-bet"></div>
                            <div class="action-bubble"></div>
                            <div class="hole-cards">
                                <div class="hole-card"></div>
                                <div class="hole-card"></div>
                            </div>
                            <div
                                class="player-action-popup"
                                style="display: none"
                            >
                                <div class="action-panel">
                                    <div class="quick-bet-sizes">
                                        <button data-size-multiplier="0.33">
                                            <span>1/3</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="0.5">
                                            <span>1/2</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="0.66">
                                            <span>2/3</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="1">
                                            <span>1</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="1.2">
                                            <span>1.2</span><small>0</small>
                                        </button>
                                    </div>
                                    <div class="main-action-buttons">
                                        <button
                                            class="main-action-btn fold"
                                            data-action="FOLD"
                                        >
                                            弃牌
                                        </button>
                                        <button
                                            class="main-action-btn bet-raise"
                                            data-action="BET"
                                        >
                                            下注
                                        </button>
                                        <button
                                            class="main-action-btn check-call"
                                            data-action="CHECK"
                                        >
                                            让牌
                                        </button>
                                    </div>
                                </div>
                                <div
                                    class="amount-slider-overlay"
                                    style="display: none"
                                >
                                    <div class="slider-container">
                                        <div class="slider-value-display">
                                            0
                                        </div>
                                        <div class="slider-track-container">
                                            <input
                                                type="range"
                                                class="bet-slider-input"
                                                min="0"
                                                max="100"
                                                step="1"
                                                value="0"
                                            />
                                        </div>
                                        <button
                                            class="main-action-btn confirm-bet"
                                            data-action="CONFIRM"
                                        >
                                            确定
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="player" data-player="P5">
                            <div class="fold-indicator">FOLD</div>
                            <div class="player-info">
                                P5 <span class="player-role"></span><br /><span
                                    class="stack"
                                ></span>
                            </div>
                            <div class="player-bet"></div>
                            <div class="action-bubble"></div>
                            <div class="hole-cards">
                                <div class="hole-card"></div>
                                <div class="hole-card"></div>
                            </div>
                            <div
                                class="player-action-popup"
                                style="display: none"
                            >
                                <div class="action-panel">
                                    <div class="quick-bet-sizes">
                                        <button data-size-multiplier="0.33">
                                            <span>1/3</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="0.5">
                                            <span>1/2</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="0.66">
                                            <span>2/3</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="1">
                                            <span>1</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="1.2">
                                            <span>1.2</span><small>0</small>
                                        </button>
                                    </div>
                                    <div class="main-action-buttons">
                                        <button
                                            class="main-action-btn fold"
                                            data-action="FOLD"
                                        >
                                            弃牌
                                        </button>
                                        <button
                                            class="main-action-btn bet-raise"
                                            data-action="BET"
                                        >
                                            下注
                                        </button>
                                        <button
                                            class="main-action-btn check-call"
                                            data-action="CHECK"
                                        >
                                            让牌
                                        </button>
                                    </div>
                                </div>
                                <div
                                    class="amount-slider-overlay"
                                    style="display: none"
                                >
                                    <div class="slider-container">
                                        <div class="slider-value-display">
                                            0
                                        </div>
                                        <div class="slider-track-container">
                                            <input
                                                type="range"
                                                class="bet-slider-input"
                                                min="0"
                                                max="100"
                                                step="1"
                                                value="0"
                                            />
                                        </div>
                                        <button
                                            class="main-action-btn confirm-bet"
                                            data-action="CONFIRM"
                                        >
                                            确定
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="player" data-player="P6">
                            <div class="fold-indicator">FOLD</div>
                            <div class="player-info">
                                P6 <span class="player-role"></span><br /><span
                                    class="stack"
                                ></span>
                            </div>
                            <div class="player-bet"></div>
                            <div class="action-bubble"></div>
                            <div class="hole-cards">
                                <div class="hole-card"></div>
                                <div class="hole-card"></div>
                            </div>
                            <div
                                class="player-action-popup"
                                style="display: none"
                            >
                                <div class="action-panel">
                                    <div class="quick-bet-sizes">
                                        <button data-size-multiplier="0.33">
                                            <span>1/3</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="0.5">
                                            <span>1/2</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="0.66">
                                            <span>2/3</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="1">
                                            <span>1</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="1.2">
                                            <span>1.2</span><small>0</small>
                                        </button>
                                    </div>
                                    <div class="main-action-buttons">
                                        <button
                                            class="main-action-btn fold"
                                            data-action="FOLD"
                                        >
                                            弃牌
                                        </button>
                                        <button
                                            class="main-action-btn bet-raise"
                                            data-action="BET"
                                        >
                                            下注
                                        </button>
                                        <button
                                            class="main-action-btn check-call"
                                            data-action="CHECK"
                                        >
                                            让牌
                                        </button>
                                    </div>
                                </div>
                                <div
                                    class="amount-slider-overlay"
                                    style="display: none"
                                >
                                    <div class="slider-container">
                                        <div class="slider-value-display">
                                            0
                                        </div>
                                        <div class="slider-track-container">
                                            <input
                                                type="range"
                                                class="bet-slider-input"
                                                min="0"
                                                max="100"
                                                step="1"
                                                value="0"
                                            />
                                        </div>
                                        <button
                                            class="main-action-btn confirm-bet"
                                            data-action="CONFIRM"
                                        >
                                            确定
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="player" data-player="P7">
                            <div class="fold-indicator">FOLD</div>
                            <div class="player-info">
                                P7 <span class="player-role"></span><br /><span
                                    class="stack"
                                ></span>
                            </div>
                            <div class="player-bet"></div>
                            <div class="action-bubble"></div>
                            <div class="hole-cards">
                                <div class="hole-card"></div>
                                <div class="hole-card"></div>
                            </div>
                            <div
                                class="player-action-popup"
                                style="display: none"
                            >
                                <div class="action-panel">
                                    <div class="quick-bet-sizes">
                                        <button data-size-multiplier="0.33">
                                            <span>1/3</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="0.5">
                                            <span>1/2</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="0.66">
                                            <span>2/3</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="1">
                                            <span>1</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="1.2">
                                            <span>1.2</span><small>0</small>
                                        </button>
                                    </div>
                                    <div class="main-action-buttons">
                                        <button
                                            class="main-action-btn fold"
                                            data-action="FOLD"
                                        >
                                            弃牌
                                        </button>
                                        <button
                                            class="main-action-btn bet-raise"
                                            data-action="BET"
                                        >
                                            下注
                                        </button>
                                        <button
                                            class="main-action-btn check-call"
                                            data-action="CHECK"
                                        >
                                            让牌
                                        </button>
                                    </div>
                                </div>
                                <div
                                    class="amount-slider-overlay"
                                    style="display: none"
                                >
                                    <div class="slider-container">
                                        <div class="slider-value-display">
                                            0
                                        </div>
                                        <div class="slider-track-container">
                                            <input
                                                type="range"
                                                class="bet-slider-input"
                                                min="0"
                                                max="100"
                                                step="1"
                                                value="0"
                                            />
                                        </div>
                                        <button
                                            class="main-action-btn confirm-bet"
                                            data-action="CONFIRM"
                                        >
                                            确定
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="player" data-player="P8">
                            <div class="fold-indicator">FOLD</div>
                            <div class="player-info">
                                P8 <span class="player-role"></span><br /><span
                                    class="stack"
                                ></span>
                            </div>
                            <div class="player-bet"></div>
                            <div class="action-bubble"></div>
                            <div class="hole-cards">
                                <div class="hole-card"></div>
                                <div class="hole-card"></div>
                            </div>
                            <div
                                class="player-action-popup"
                                style="display: none"
                            >
                                <div class="action-panel">
                                    <div class="quick-bet-sizes">
                                        <button data-size-multiplier="0.33">
                                            <span>1/3</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="0.5">
                                            <span>1/2</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="0.66">
                                            <span>2/3</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="1">
                                            <span>1</span><small>0</small>
                                        </button>
                                        <button data-size-multiplier="1.2">
                                            <span>1.2</span><small>0</small>
                                        </button>
                                    </div>
                                    <div class="main-action-buttons">
                                        <button
                                            class="main-action-btn fold"
                                            data-action="FOLD"
                                        >
                                            弃牌
                                        </button>
                                        <button
                                            class="main-action-btn bet-raise"
                                            data-action="BET"
                                        >
                                            下注
                                        </button>
                                        <button
                                            class="main-action-btn check-call"
                                            data-action="CHECK"
                                        >
                                            让牌
                                        </button>
                                    </div>
                                </div>
                                <div
                                    class="amount-slider-overlay"
                                    style="display: none"
                                >
                                    <div class="slider-container">
                                        <div class="slider-value-display">
                                            0
                                        </div>
                                        <div class="slider-track-container">
                                            <input
                                                type="range"
                                                class="bet-slider-input"
                                                min="0"
                                                max="100"
                                                step="1"
                                                value="0"
                                            />
                                        </div>
                                        <button
                                            class="main-action-btn confirm-bet"
                                            data-action="CONFIRM"
                                        >
                                            确定
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="pot-display" class="pot-display">
                            底池: <span id="pot-amount">0</span>
                        </div>
                        <div class="community-cards">
                            <div class="card community-card"></div>
                            <div class="card community-card"></div>
                            <div class="card community-card"></div>
                            <div class="card community-card"></div>
                            <div class="card community-card"></div>
                        </div>
                    </div>
                    <div class="action-bar">
                        <div id="game-controls">
                            <button id="start-btn" class="game-control-btn">
                                ▶️ 开始牌局
                            </button>
                            <button
                                id="pause-btn"
                                class="game-control-btn"
                                disabled
                            >
                                ⏸️ 暂停
                            </button>
                            <button
                                id="save-snapshot-btn"
                                class="game-control-btn"
                            >
                                📸 保存快照
                            </button>
                        </div>
                        <div
                            id="replay-controls"
                            style="display: none; gap: 10px"
                        >
                            <button
                                id="replay-play-pause-btn"
                                class="game-control-btn"
                            >
                                ▶️ 播放
                            </button>
                            <button
                                id="replay-next-btn"
                                class="game-control-btn"
                            >
                                ⏭️ 下一步
                            </button>
                            <button
                                id="replay-prev-btn"
                                class="game-control-btn"
                            >
                                ⏮️ 上一步
                            </button>
                            <button
                                id="replay-reset-btn"
                                class="game-control-btn"
                            >
                                🔄 重置
                            </button>
                            <button
                                id="replay-exit-btn"
                                class="game-control-btn danger-btn"
                            >
                                ⏹️ 退出
                            </button>
                        </div>
                        <button id="config-toggle-btn" class="game-control-btn">
                            <i class="material-icons">settings</i>
                            <span>配置</span>
                        </button>
                    </div>
                </div>

                <div class="info-panel-area">
                    <div class="section">
                        <h3>📊 玩家行动 (ActionSheet)</h3>
                        <div id="action-sheet-container">
                            <table id="action-sheet">
                                <thead>
                                    <tr>
                                        <th>玩家</th>
                                        <th colspan="4">PREFLOP</th>
                                        <th colspan="4">FLOP</th>
                                        <th colspan="4">TURN</th>
                                        <th colspan="4">RIVER</th>
                                    </tr>
                                </thead>
                                <tbody id="action-sheet-body"></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="section">
                        <h3>💡 GTO 建议</h3>
                        <div id="suggestion-display">等待玩家行动...</div>
                    </div>
                    <div
                        class="section"
                        style="
                            display: flex;
                            flex-direction: column;
                            flex-grow: 1;
                        "
                    >
                        <h3>📜 Console 日志</h3>
                        <textarea id="console-log" readonly></textarea>
                    </div>
                </div>
            </main>
        </div>
        <!-- Snapshot Confirmation Modal -->
        <div id="snapshot-modal" class="modal-overlay">
            <div class="modal-content">
                <h3>确认快照</h3>
                <div class="modal-body">
                    <p>为快照命名并确认保存。取消后将不会保存任何数据。</p>
                    <input
                        type="text"
                        id="snapshot-name-input"
                        placeholder="输入快照名称（可选）"
                        style="
                            width: 100%;
                            padding: 8px;
                            margin-bottom: 10px;
                            border: 1px solid #ccc;
                            border-radius: 4px;
                        "
                    />
                    <img
                        id="snapshot-preview"
                        src=""
                        alt="牌局快照预览"
                        style="
                            max-width: 100%;
                            height: auto;
                            border: 1px solid #ccc;
                            margin-bottom: 10px;
                        "
                    />
                </div>
                <div class="modal-footer">
                    <button
                        id="save-snapshot-confirm-btn"
                        class="game-control-btn"
                    >
                        确认保存
                    </button>
                    <button
                        id="recapture-snapshot-btn"
                        class="game-control-btn"
                        style="background-color: #007bff"
                    >
                        重新截取
                    </button>
                    <button
                        id="cancel-snapshot-btn"
                        class="game-control-btn secondary-btn"
                    >
                        取消
                    </button>
                </div>
            </div>
        </div>

        <!-- View Snapshot Modal -->
        <div id="view-snapshot-modal" class="modal-overlay">
            <div
                class="modal-content"
                style="
                    width: 95vw;
                    max-width: 1200px;
                    height: 90vh;
                    display: flex;
                    flex-direction: column;
                "
            >
                <h3 id="view-snapshot-title" style="flex-shrink: 0">
                    查看快照建议
                </h3>
                <div
                    class="modal-body"
                    style="
                        display: flex;
                        flex-direction: column;
                        flex-grow: 1;
                        overflow: hidden;
                    "
                >
                    <div
                        id="view-snapshot-image-container"
                        style="
                            position: relative;
                            flex-basis: 40%;
                            flex-shrink: 0;
                            overflow: auto;
                            text-align: center;
                            border-bottom: 1px solid #ccc;
                            padding-bottom: 10px;
                            margin-bottom: 10px;
                        "
                    >
                        <img
                            id="view-snapshot-image"
                            src=""
                            alt="牌局快照"
                            style="
                                max-width: 100%;
                                max-height: 100%;
                                object-fit: contain;
                                cursor: pointer;
                            "
                        />
                        <div id="image-hover-overlay">
                            <span
                                style="
                                    display: flex;
                                    align-items: center;
                                    gap: 8px;
                                "
                                ><i class="material-icons">zoom_in</i>
                                查看大图</span
                            >
                        </div>
                    </div>
                    <div
                        id="snapshot-suggestion-filter-container"
                        style="
                            flex-shrink: 0;
                            padding: 5px 10px;
                            border-bottom: 1px solid #ccc;
                            margin-bottom: 5px;
                            display: flex;
                            flex-wrap: wrap;
                            align-items: center;
                            gap: 15px;
                        "
                    >
                        <!-- 筛选器将动态生成在这里 -->
                    </div>
                    <div
                        id="view-snapshot-suggestions-list"
                        style="
                            flex-grow: 1;
                            overflow-y: auto;
                            background: #f9f9f9;
                            padding: 10px;
                            border-radius: 4px;
                        "
                    >
                        <!-- Suggestions will be rendered here by JS -->
                    </div>
                </div>
                <div class="modal-footer" style="flex-shrink: 0">
                    <button
                        id="save-snapshot-remarks-btn"
                        class="game-control-btn"
                    >
                        保存批注
                    </button>
                    <button
                        id="close-view-snapshot-modal-btn"
                        class="game-control-btn secondary-btn"
                    >
                        关闭
                    </button>
                </div>
            </div>
        </div>

        <!-- End of Hand Save Prompt Modal -->
        <div id="end-of-hand-modal" class="modal-overlay">
            <div class="modal-content" style="max-width: 400px">
                <h3>牌局结束</h3>
                <div class="modal-body">
                    <p>是否需要为本局游戏保存快照？</p>
                </div>
                <div class="modal-footer">
                    <button
                        id="eoh-confirm-save"
                        class="game-control-btn"
                        style="background-color: var(--accent-color)"
                    >
                        确认
                    </button>
                    <button
                        id="eoh-cancel-save"
                        class="game-control-btn secondary-btn"
                    >
                        取消
                    </button>
                </div>
            </div>
        </div>

        <!-- Screenshot Selection Overlay -->
        <div id="screenshot-selection-overlay" style="display: none">
            <div id="selection-box"></div>
        </div>

        <!-- Delete Confirmation Popover -->
        <div id="delete-confirm-popover" style="display: none">
            <p>确定删除此快照？</p>
            <div class="popover-actions">
                <button id="delete-confirm-yes" class="game-control-btn">
                    确认
                </button>
                <button
                    id="delete-confirm-no"
                    class="game-control-btn secondary-btn"
                >
                    取消
                </button>
            </div>
        </div>

        <!-- Image Lightbox Overlay -->
        <div
            id="image-lightbox-overlay"
            style="
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.85);
                z-index: 4000;
                justify-content: center;
                align-items: center;
                cursor: pointer;
            "
        >
            <img
                id="lightbox-image"
                src=""
                style="
                    max-width: 90%;
                    max-height: 90%;
                    object-fit: contain;
                    border-radius: 4px;
                "
            />
        </div>

        <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
        <!-- Global Loader -->
        <div
            id="global-loader-overlay"
            class="loader-overlay"
            style="display: none"
        >
            <div class="loader-spinner"></div>
        </div>

        <script type="module" src="main.js"></script>
    </body>
</html>
